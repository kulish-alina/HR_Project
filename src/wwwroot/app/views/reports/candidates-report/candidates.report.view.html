<div class="grid-block">
   <div class="medium-2 grid-block">
      <div class="sidebar report-sidebar">
         <div class="card-divider">
            <div class="grid-block">
               <div class="medium-8 grid-block" ng-bind="::'REPORTS.REPORT_CONDITIONS' | translate"></div>
               <div class="medium-4 grid-block align-right">
                  <a ng-click="clear()" ng-bind="::'COMMON.CLEAR' | translate"></a>
               </div>
            </div>
         </div>
         <div class="card-section">
            <form name="CandidatesConditionsReport">
               <label ng-bind="::'REPORTS.DATE_RANGE' | translate"></label>
               <div class="grid-block">
                  <div class="medium-6 grid-block report-date-input">
                     <input valid-method="watch" class="date-input" placeholder="{{::'COMMON.FROM' | translate}}" ng-model="startDate" class="input-date" datetime-picker date-format="dd-MM-yyyy" close-on-select="true" date-only ui-mask="99-99-9999" ui-mask-placeholder ui-mask-placeholder-char="_" model-view-value="true" name="startDate" model-view-value="true" type="tel" validator="date" /> </div>
                  <div class="medium-6 grid-block report-date-input">
                     <input valid-method="watch" class="date-input" type="tel" min-date="{{startDate}}" placeholder="{{::'COMMON.TO' | translate}}" ng-model="endDate" class="input-date" datetime-picker date-format="dd-MM-yyyy" close-on-select="true" date-only ui-mask="99-99-9999" ui-mask-placeholder ui-mask-placeholder-char="_" model-view-value="true" name="endDate" validator="date" /> </div>
               </div>
               <label for="Candidate" ng-bind="::'CANDIDATE.CANDIDATE' | translate"></label>
               <div class="grid-block">
                  <oi-select class="multiple-select" oi-options="candidate.id as candidate.lastName +' '+candidate.firstName+' '+(candidate.city.title || '')+' '+(candidate.birthDate || '')
                                      for candidate in candidatesAutocomplete($query)  | orderBy : 'lastName + \'|\' + firstName'" ng-model="candidatesReportParametrs.candidatesIds" multiple oi-select-options="{ cleanModel: true }" placeholder="{{::'CANDIDATE.CANDIDATE' | translate}}"> </oi-select>
               </div>
               <label ng-bind="::'THESAURUSES.LOCATIONS' | translate"></label>
               <div ng-if="isInited" class="grid-block location-input">
                  <oi-select ng-change="locationSwitch()"  class="multiple-select" oi-options="city.id as city.title for city in locations | orderBy : 'title'" ng-model="candidatesReportParametrs.locationsIds" multiple oi-select-options="{ cleanModel: true }" placeholder="{{::'COMMON.LOCATION' | translate}}" name="locations" validator="required"> </oi-select>
               </div>
               <div class="vertical grid-block">
                  <div class="stage-button" ng-click="stageSwitch(stage)" ng-repeat="stage in stages  | orderBy:'$index':true" ng-class="{'pressed': stage._isPressed}"> <span class='stage-button-text' ng-bind="stage.title"></span> </div>
               </div>
               <a class="expand button" ng-click="generateCandidatesReport(CandidatesConditionsReport)" ng-bind="::'REPORTS.GENERATE' | translate"></a>
            </form>
         </div>
      </div>
   </div>
   <div class="vertical medium-10 grid-block">
      <div class="main-card">
         <div class="card-divider"> 
            <div class="grid-block">
               <div class="madium-6 grid-block">
                  <span ng-bind="::'REPORTS.CANDIDATES_REPORT_DATA' | translate"></span>
                  <span ng-if="vacanciesReportParametrs.startDate" ng-bind="::'COMMON.FROM' | translate"></span>
                  <span class="date" ng-bind="vacanciesReportParametrs.startDate"></span>
                  <span ng-if="vacanciesReportParametrs.endDate" ng-bind="::'COMMON.TO' | translate"></span>
                  <span class="date" ng-bind="vacanciesReportParametrs.endDate"></span> 
               </div>
               <div class="align-right madium-6 grid-block">
                  <a target="_blank" href="{{exportToExcel()}}" ng-bind="::'REPORTS.EXPORT_TO_EXCEL' | translate" class="button"></a>
               </div>
            </div>
         </div>
         <div class="card-section candidates-report">
            <table class="report-data">
               <thead>
                  <tr class="report-data-row">
                     <th ng-bind="::'COMMON.LOCATION' | translate" rowspan="3"></th>
                     <th ng-bind="::'CANDIDATES.CANDIDATES' | translate" rowspan="3"></th>
                     <th ng-bind="::'VACANCIES.VACANCIES' | translate" rowspan="3"></th>
                     <th class="report-column" colspan="26"> <span ng-bind="::'THESAURUSES.STAGES' | translate"></span> </th>
                  </tr>
                  <tr class="report-data-row">
                     <th ng-if="selectedStageIds.includes(stage.id)" colspan="2" ng-bind="stage.title" class="stages-column" ng-repeat="stage in stages | orderBy:'$index':true">
                  </tr>
                  <tr class="report-data-row">
                     <th ng-repeat-start="col in tableColumnsCount" class="report-column" ng-bind="::'COMMON.DATE' | translate"></th>
                     <th ng-repeat-end="col in tableColumnsCount" class="report-column" ng-bind="::'COMMON.COMMENTS' | translate"></th>
                  </tr>
               </thead>
               <tbody ng-repeat="selectedLocation in selectedLocations">
                  <tr class="report-data-row">
                     <td ng-bind="selectedLocation.title" rowspan="{{responseTableObject[selectedLocation.id].length}}"> </td>
                     <td ng-bind="(responseTableObject[selectedLocation.id][0].candidateLastName+' '+responseTableObject[selectedLocation.id][0].candidateFirstName)"></td>
                     <td ng-bind="responseTableObject[selectedLocation.id][0].vacancyTitle"></td>
                     <td class="passed-date-column" ng-if="selectedStageIds.includes(stage.id)" ng-repeat-start="stage in stages | orderBy:'$index':true"> <span ng-bind="filterArrayByProperty(responseTableObject[selectedLocation.id][0], stage.id, 'passDate') | date:'dd-MM-yyyy'"></span> </td>
                     <td ng-if="selectedStageIds.includes(stage.id)" ng-repeat-end="stage in stages | orderBy:'$index':true"> <span ng-bind="filterArrayByProperty(responseTableObject[selectedLocation.id][0], stage.id, 'comment')"></span> </td>
                  </tr>
                  <tr class="report-data-row" ng-repeat="object in responseTableObject[selectedLocation.id]" ng-show="!$first">
                     <td ng-bind="(object.candidateLastName+' '+object.candidateFirstName)"></td>
                     <td ng-bind="object.vacancyTitle"></td>
                     <td class="passed-date-column" ng-if="selectedStageIds.includes(stage.id)" ng-repeat-start="stage in stages | orderBy:'$index':true"> <span ng-bind="filterArrayByProperty(object, stage.id, 'passDate') | date:'dd-MM-yyyy'"></span> </td>
                     <td ng-if="selectedStageIds.includes(stage.id)" ng-repeat-end="stage in stages | orderBy:'$index':true"> <span ng-bind="filterArrayByProperty(object, stage.id, 'comment')"></span> </td>
                  </tr>
               </tbody>
            </table>
         </div>
      </div>
   </div>
</div>
